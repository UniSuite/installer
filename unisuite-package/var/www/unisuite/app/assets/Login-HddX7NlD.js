import{_ as g,E as c,M as h,T as f,c as y,a as t,x as w,t as a,b as i,i as p,v as u,d,w as m,F as _,r as v,o as k}from"./index-CwdP5cl5.js";import{a as b}from"./axios-BimPEqV4.js";const x={data(){return{year:new Date().getFullYear(),form:{username:"",password:"",token:""},errorMessage:"",modal2FA:""}},mounted(){const s=c();s.appSidebarHide=!0,s.appHeaderHide=!0,s.appFooter=!1,s.appContentClass="p-0",this.modal2FA=new h(document.getElementById("modal2FA"))},beforeUnmount(){const s=c();s.appSidebarHide=!1,s.appHeaderHide=!1,s.appFooter=!0,s.appContentClass=""},methods:{async submitForm(){try{const s=await b.post("http://localhost:1505/api/auth/login",{username:this.form.username,password:this.form.password});localStorage.setItem("id_token",s.data.id_token),localStorage.setItem("access_token",s.data.access_token),this.$router.push("/")}catch(s){s.response&&s.response.data=="2FA token required"?this.modal2FA.toggle():(this.errorMessage=s.response?s.response.data:"Die Anfrage konnte nicht verarbeitet werden. Versuche es später erneut!",new f(document.getElementById("toastError")).show())}},async submit2FA(){try{const s=await b.post("http://localhost:1505/api/auth/login",{username:this.form.username,password:this.form.password,token:this.form.token});localStorage.setItem("id_token",s.data.id_token),localStorage.setItem("access_token",s.data.access_token),this.$router.push("/")}catch(s){this.errorMessage=s.response?s.response.data:"Dein Code konnte nicht geprüft werden. Versuche es später erneut!",new f(document.getElementById("toastError")).show()}},togglePWV(){const s=document.getElementById("pweye"),e=document.getElementById("pwField");s.classList.contains("fa-eye")?(s.classList.replace("fa-eye","fa-eye-slash"),e.type="text"):(s.classList.replace("fa-eye-slash","fa-eye"),e.type="password")}}},A={class:"login"},F={class:"login-content"},E={class:"text-center"},I={class:"text-inverse text-opacity-50 text-center mb-4"},L={class:"mb-3"},T={class:"d-flex"},S={class:"form-label"},C={class:"input-group flex-nowrap"},O={class:"mb-3"},M={class:"d-flex"},H={class:"form-label"},N={class:"input-group flex-nowrap"},P={class:"mb-3"},V={class:"row align-items-center"},B={class:"col-6"},U={class:"form-check"},D={class:"form-check-label",for:"customCheck1"},G={class:"col-6 text-end"},R={type:"submit",class:"btn btn-outline-theme btn-lg d-block w-100 fw-500 mb-3"},W={class:"fixed-bottom mb-2 text-center small text-inverse text-opacity-50"},z={href:"https://unisuite.de/",target:"_blank"},q={class:"modal fade",id:"modal2FA","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"modal2FALabel","aria-hidden":"true"},$={class:"modal-dialog modal-dialog-centered"},j={class:"modal-content"},J={class:"modal-body"},K={class:"row d-flex justify-content-center"},Y={class:"col-3 mt-3"},Z={class:"modal-footer"},Q={class:"toasts-container"},X={class:"toast bg-warning bg-opacity-50","data-autohide":"true",id:"toastError"},tt={class:"toast-body"};function et(s,e,st,ot,n,l){const r=v("RouterLink");return k(),y(_,null,[t("div",A,[t("div",F,[t("form",{onSubmit:e[3]||(e[3]=w((...o)=>l.submitForm&&l.submitForm(...o),["prevent"])),method:"POST",name:"login_form"},[t("h1",E,a(s.$t("AUTH.LOGIN.TITLE")),1),t("div",I,a(s.$t("AUTH.LOGIN.DESC")),1),t("div",L,[t("div",T,[t("label",S,[i(a(s.$t("GENERAL.EMAIL"))+" ",1),e[6]||(e[6]=t("span",{class:"text-danger"},"*",-1))])]),t("div",C,[e[7]||(e[7]=t("i",{class:"fa-solid fa-image-portrait input-group-text",id:"addon-wrapping"},null,-1)),p(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>n.form.username=o),type:"email",class:"form-control form-control-lg bg-white bg-opacity-5 fs-14px",required:""},null,512),[[u,n.form.username]])])]),t("div",O,[t("div",M,[t("label",H,[i(a(s.$t("GENERAL.PASSWORD"))+" ",1),e[8]||(e[8]=t("span",{class:"text-danger"},"*",-1))]),d(r,{to:"/auth/recover",class:"ms-auto text-inverse text-decoration-none text-opacity-50"},{default:m(()=>[i(a(s.$t("AUTH.LOGIN.PWFORGOT")),1)]),_:1})]),t("div",N,[e[10]||(e[10]=t("i",{class:"fa-solid fa-key input-group-text",id:"addon-wrapping"},null,-1)),p(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>n.form.password=o),type:"password",id:"pwField",class:"form-control form-control-lg bg-white bg-opacity-5 fs-14px",required:""},null,512),[[u,n.form.password]]),t("button",{type:"button",onClick:e[2]||(e[2]=(...o)=>l.togglePWV&&l.togglePWV(...o)),class:"input-group-text"},e[9]||(e[9]=[t("i",{id:"pweye",class:"fa fa-eye"},null,-1)]))])]),t("div",P,[t("div",V,[t("div",B,[t("div",U,[e[11]||(e[11]=t("input",{class:"form-check-input",type:"checkbox",value:"",id:"customCheck1"},null,-1)),t("label",D,a(s.$t("AUTH.LOGIN.REMEMBER")),1)])]),t("div",G,[d(r,{to:"",class:"text-body"},{default:m(()=>e[12]||(e[12]=[t("i",{class:"fa-brands fa-apple fa-xl m-2 align-middle",style:{height:"0.2em"}},null,-1)])),_:1}),d(r,{to:"",class:"text-body"},{default:m(()=>e[13]||(e[13]=[t("i",{class:"fa-brands fa-google fa-lg m-2 align-middle"},null,-1)])),_:1}),d(r,{to:"",class:"text-body"},{default:m(()=>e[14]||(e[14]=[t("i",{class:"fa-brands fa-microsoft fa-lg m-2 align-middle"},null,-1)])),_:1})])])]),t("button",R,a(s.$t("AUTH.LOGIN.TITLE")),1)],32),t("div",W,[i(" © "+a(n.year)+" ",1),t("a",z,a(s.$t("APP.NAME")),1),i(" - "+a(s.$t("APP.LIC"))+". ",1)])])]),t("div",q,[t("div",$,[t("div",j,[e[17]||(e[17]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"modal2FALabel"},"2-Faktor Authentifizierung")],-1)),t("div",J,[t("div",K,[e[15]||(e[15]=t("div",{class:"col-12 text-center"},"Da Sie die Zwei-Faktor-Authentifizierung in Ihrem Konto eingerichtet haben, müssen Sie nun den Code aus Ihrer Authenticator-App (TOTP) eingeben, um mit der Anmeldung fortzufahren.",-1)),t("div",Y,[p(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>n.form.token=o),type:"number",class:"form-control",min:"6",max:"6",placeholder:"### ###"},null,512),[[u,n.form.token]])])])]),t("div",Z,[e[16]||(e[16]=t("button",{type:"button",class:"btn btn-outline-default","data-bs-dismiss":"modal"},"Abbrechen",-1)),t("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:e[5]||(e[5]=(...o)=>l.submit2FA&&l.submit2FA(...o))},"Anmelden")])])])]),t("div",Q,[t("div",X,[e[18]||(e[18]=t("div",{class:"toast-header"},[t("i",{class:"far fa-triangle-exclamation text-muted me-2"}),t("strong",{class:"me-auto"},"Fehler"),t("small",null,"Jetzt")],-1)),t("div",tt,a(this.errorMessage),1)])])],64)}const lt=g(x,[["render",et]]);export{lt as default};
