import{_ as g,u as c,M as h,T as f,c as y,a as e,w,t as a,b as l,d as p,v as u,e as d,f as m,F as _,r as v,o as k}from"./index-BuZhHD2q.js";import{a as b}from"./axios-CCb-kr4I.js";const x={data(){return{year:new Date().getFullYear(),form:{username:"",password:"",token:""},errorMessage:"",modal2FA:""}},mounted(){const s=c();s.appSidebarHide=!0,s.appHeaderHide=!0,s.appFooter=!1,s.appContentClass="p-0",this.modal2FA=new h(document.getElementById("modal2FA"))},beforeUnmount(){const s=c();s.appSidebarHide=!1,s.appHeaderHide=!1,s.appFooter=!0,s.appContentClass=""},methods:{async submitForm(){try{const s=await b.post("https://api.unisuite.de/auth/login",{username:this.form.username,password:this.form.password});localStorage.setItem("id_token",s.data.id_token),localStorage.setItem("access_token",s.data.access_token),this.$router.push("/")}catch(s){s.response&&s.response.data=="2FA token required"?this.modal2FA.toggle():(this.errorMessage=s.response?s.response.data:"Die Anfrage konnte nicht verarbeitet werden. Versuche es später erneut!",new f(document.getElementById("toastError")).show())}},async submit2FA(){try{const s=await b.post("https://api.unisuite.de/auth/login",{username:this.form.username,password:this.form.password,token:this.form.token});localStorage.setItem("id_token",s.data.id_token),localStorage.setItem("access_token",s.data.access_token),this.$router.push("/")}catch(s){this.errorMessage=s.response?s.response.data:"Dein Code konnte nicht geprüft werden. Versuche es später erneut!",new f(document.getElementById("toastError")).show()}},togglePWV(){const s=document.getElementById("pweye"),t=document.getElementById("pwField");s.classList.contains("fa-eye")?(s.classList.replace("fa-eye","fa-eye-slash"),t.type="text"):(s.classList.replace("fa-eye-slash","fa-eye"),t.type="password")}}},A={class:"login"},F={class:"login-content"},E={class:"text-center"},I={class:"text-inverse text-opacity-50 text-center mb-4"},L={class:"mb-3"},T={class:"d-flex"},S={class:"form-label"},C={class:"input-group flex-nowrap"},O={class:"mb-3"},M={class:"d-flex"},H={class:"form-label"},N={class:"input-group flex-nowrap"},P={class:"mb-3"},V={class:"row align-items-center"},B={class:"col-6"},U={class:"form-check"},D={class:"form-check-label",for:"customCheck1"},G={class:"col-6 text-end"},R={type:"submit",class:"btn btn-outline-theme btn-lg d-block w-100 fw-500 mb-3"},W={class:"fixed-bottom mb-2 text-center small text-inverse text-opacity-50"},z={href:"https://unisuite.de/",target:"_blank"},q={class:"modal fade",id:"modal2FA","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"modal2FALabel","aria-hidden":"true"},$={class:"modal-dialog modal-dialog-centered"},j={class:"modal-content"},J={class:"modal-body"},K={class:"row d-flex justify-content-center"},Y={class:"col-3 mt-3"},Z={class:"modal-footer"},Q={class:"toasts-container"},X={class:"toast bg-warning bg-opacity-50","data-autohide":"true",id:"toastError"},ee={class:"toast-body"};function te(s,t,se,oe,n,i){const r=v("RouterLink");return k(),y(_,null,[e("div",A,[e("div",F,[e("form",{onSubmit:t[3]||(t[3]=w((...o)=>i.submitForm&&i.submitForm(...o),["prevent"])),method:"POST",name:"login_form"},[e("h1",E,a(s.$t("AUTH.LOGIN.TITLE")),1),e("div",I,a(s.$t("AUTH.LOGIN.DESC")),1),e("div",L,[e("div",T,[e("label",S,[l(a(s.$t("GENERAL.EMAIL"))+" ",1),t[6]||(t[6]=e("span",{class:"text-danger"},"*",-1))])]),e("div",C,[t[7]||(t[7]=e("i",{class:"fa-solid fa-image-portrait input-group-text",id:"addon-wrapping"},null,-1)),p(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>n.form.username=o),type:"email",class:"form-control form-control-lg bg-white bg-opacity-5 fs-14px",required:""},null,512),[[u,n.form.username]])])]),e("div",O,[e("div",M,[e("label",H,[l(a(s.$t("GENERAL.PASSWORD"))+" ",1),t[8]||(t[8]=e("span",{class:"text-danger"},"*",-1))]),d(r,{to:"/recover",class:"ms-auto text-inverse text-decoration-none text-opacity-50"},{default:m(()=>[l(a(s.$t("AUTH.LOGIN.PWFORGOT")),1)]),_:1})]),e("div",N,[t[10]||(t[10]=e("i",{class:"fa-solid fa-key input-group-text",id:"addon-wrapping"},null,-1)),p(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>n.form.password=o),type:"password",id:"pwField",class:"form-control form-control-lg bg-white bg-opacity-5 fs-14px",required:""},null,512),[[u,n.form.password]]),e("button",{type:"button",onClick:t[2]||(t[2]=(...o)=>i.togglePWV&&i.togglePWV(...o)),class:"input-group-text"},t[9]||(t[9]=[e("i",{id:"pweye",class:"fa fa-eye"},null,-1)]))])]),e("div",P,[e("div",V,[e("div",B,[e("div",U,[t[11]||(t[11]=e("input",{class:"form-check-input",type:"checkbox",value:"",id:"customCheck1"},null,-1)),e("label",D,a(s.$t("AUTH.LOGIN.REMEMBER")),1)])]),e("div",G,[d(r,{to:"",class:"text-body"},{default:m(()=>t[12]||(t[12]=[e("i",{class:"fa-brands fa-apple fa-xl m-2 align-middle",style:{height:"0.2em"}},null,-1)])),_:1}),d(r,{to:"",class:"text-body"},{default:m(()=>t[13]||(t[13]=[e("i",{class:"fa-brands fa-google fa-lg m-2 align-middle"},null,-1)])),_:1}),d(r,{to:"",class:"text-body"},{default:m(()=>t[14]||(t[14]=[e("i",{class:"fa-brands fa-microsoft fa-lg m-2 align-middle"},null,-1)])),_:1})])])]),e("button",R,a(s.$t("AUTH.LOGIN.TITLE")),1)],32),e("div",W,[l(" © "+a(n.year)+" ",1),e("a",z,a(s.$t("APP.NAME")),1),l(" - "+a(s.$t("APP.LIC"))+". ",1)])])]),e("div",q,[e("div",$,[e("div",j,[t[17]||(t[17]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"modal2FALabel"},"2-Faktor Authentifizierung")],-1)),e("div",J,[e("div",K,[t[15]||(t[15]=e("div",{class:"col-12 text-center"},"Da Sie die Zwei-Faktor-Authentifizierung in Ihrem Konto eingerichtet haben, müssen Sie nun den Code aus Ihrer Authenticator-App (TOTP) eingeben, um mit der Anmeldung fortzufahren.",-1)),e("div",Y,[p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>n.form.token=o),type:"number",class:"form-control",min:"6",max:"6",placeholder:"### ###"},null,512),[[u,n.form.token]])])])]),e("div",Z,[t[16]||(t[16]=e("button",{type:"button",class:"btn btn-outline-default","data-bs-dismiss":"modal"},"Abbrechen",-1)),e("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[5]||(t[5]=(...o)=>i.submit2FA&&i.submit2FA(...o))},"Anmelden")])])])]),e("div",Q,[e("div",X,[t[18]||(t[18]=e("div",{class:"toast-header"},[e("i",{class:"far fa-triangle-exclamation text-muted me-2"}),e("strong",{class:"me-auto"},"Fehler"),e("small",null,"Jetzt")],-1)),e("div",ee,a(this.errorMessage),1)])])],64)}const ie=g(x,[["render",te]]);export{ie as default};
