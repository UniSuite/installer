import{_ as y,u as f,M as w,a as d,T as b,c as v,b as e,w as g,t as a,d as r,e as m,v as c,f as p,g as u,h as k,F as x,r as _,o as A}from"./index-unNwo0no.js";import{a as h}from"./axios-CCb-kr4I.js";const F={data(){return{year:new Date().getFullYear(),form:{username:"",password:"",token:""},errorMessage:"",modal2FA:"",rememberMe:!1}},mounted(){const s=f();s.appSidebarHide=!0,s.appHeaderHide=!0,s.appFooter=!1,s.appContentClass="p-0",this.modal2FA=new w(document.getElementById("modal2FA"))},beforeUnmount(){const s=f();s.appSidebarHide=!1,s.appHeaderHide=!1,s.appFooter=!0,s.appContentClass=""},methods:{async submitForm(){try{const s=await h.post("https://api.unisuite.de/auth/login",{username:this.form.username,password:this.form.password}),t={domain:".unisuite.de",path:"/",sameSite:"None",secure:!0,expires:this.rememberMe?1:void 0};d.set("id_token",s.data.id_token,t),d.set("access_token",s.data.access_token,t),window.location.href="https://app.unisuite.de/"}catch(s){s.response&&s.response.data=="2FA token required"?this.modal2FA.toggle():(this.errorMessage=s.response?s.response.data:"Die Anfrage konnte nicht verarbeitet werden. Versuche es später erneut!",new b(document.getElementById("toastError")).show())}},async submit2FA(){try{const s=await h.post("https://api.unisuite.de/auth/login",{username:this.form.username,password:this.form.password,token:this.form.token}),t={domain:".unisuite.de",path:"/",sameSite:"None",secure:!0,expires:this.rememberMe?1:void 0};d.set("id_token",s.data.id_token,t),d.set("access_token",s.data.access_token,t),window.location.href="https://app.unisuite.de/"}catch(s){this.errorMessage=s.response?s.response.data:"Dein Code konnte nicht geprüft werden. Versuche es später erneut!",new b(document.getElementById("toastError")).show()}},togglePWV(){const s=document.getElementById("pweye"),t=document.getElementById("pwField");s.classList.contains("fa-eye")?(s.classList.replace("fa-eye","fa-eye-slash"),t.type="text"):(s.classList.replace("fa-eye-slash","fa-eye"),t.type="password")}}},E={class:"login"},L={class:"login-content"},M={class:"text-center"},I={class:"text-inverse text-opacity-50 text-center mb-4"},T={class:"mb-3"},C={class:"d-flex"},O={class:"form-label"},N={class:"input-group flex-nowrap"},S={class:"mb-3"},V={class:"d-flex"},H={class:"form-label"},P={class:"input-group flex-nowrap"},U={class:"mb-3"},B={class:"row align-items-center"},D={class:"col-6"},G={class:"form-check"},R={class:"form-check-label",for:"rememberCheck"},W={class:"col-6 text-end"},q={type:"submit",class:"btn btn-outline-theme btn-lg d-block w-100 fw-500 mb-3"},z={class:"fixed-bottom mb-2 text-center small text-inverse text-opacity-50"},j={href:"https://unisuite.de/",target:"_blank"},J={class:"modal fade",id:"modal2FA","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"modal2FALabel","aria-hidden":"true"},K={class:"modal-dialog modal-dialog-centered"},Y={class:"modal-content"},Z={class:"modal-body"},Q={class:"row d-flex justify-content-center"},X={class:"toasts-container"},$={class:"toast bg-warning bg-opacity-50","data-autohide":"true",id:"toastError"},ee={class:"toast-body"};function te(s,t,se,oe,n,i){const l=_("RouterLink");return A(),v(x,null,[e("div",E,[e("div",L,[e("form",{onSubmit:t[4]||(t[4]=g((...o)=>i.submitForm&&i.submitForm(...o),["prevent"]))},[e("h1",M,a(s.$t("AUTH.LOGIN.TITLE")),1),e("div",I,a(s.$t("AUTH.LOGIN.DESC")),1),e("div",T,[e("div",C,[e("label",O,[r(a(s.$t("GENERAL.EMAIL"))+" ",1),t[7]||(t[7]=e("span",{class:"text-danger"},"*",-1))])]),e("div",N,[t[8]||(t[8]=e("i",{class:"fa-solid fa-image-portrait input-group-text",id:"addon-wrapping"},null,-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>n.form.username=o),type:"email",class:"form-control form-control-lg bg-white bg-opacity-5 fs-14px",autocomplete:"email",required:""},null,512),[[c,n.form.username]])])]),e("div",S,[e("div",V,[e("label",H,[r(a(s.$t("GENERAL.PASSWORD"))+" ",1),t[9]||(t[9]=e("span",{class:"text-danger"},"*",-1))]),p(l,{to:"/recover",class:"ms-auto text-inverse text-decoration-none text-opacity-50"},{default:u(()=>[r(a(s.$t("AUTH.LOGIN.PWFORGOT")),1)]),_:1})]),e("div",P,[t[11]||(t[11]=e("i",{class:"fa-solid fa-key input-group-text",id:"addon-wrapping"},null,-1)),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>n.form.password=o),type:"password",id:"pwField",class:"form-control form-control-lg bg-white bg-opacity-5 fs-14px",autocomplete:"password",required:""},null,512),[[c,n.form.password]]),e("button",{type:"button",onClick:t[2]||(t[2]=(...o)=>i.togglePWV&&i.togglePWV(...o)),class:"input-group-text"},t[10]||(t[10]=[e("i",{id:"pweye",class:"fa fa-eye"},null,-1)]))])]),e("div",U,[e("div",B,[e("div",D,[e("div",G,[m(e("input",{class:"form-check-input",type:"checkbox",id:"rememberCheck","onUpdate:modelValue":t[3]||(t[3]=o=>n.rememberMe=o)},null,512),[[k,n.rememberMe]]),e("label",R,a(s.$t("AUTH.LOGIN.REMEMBER")),1)])]),e("div",W,[p(l,{to:"",class:"text-body"},{default:u(()=>t[12]||(t[12]=[e("i",{class:"fa-brands fa-apple fa-xl m-2 align-middle",style:{height:"0.2em"}},null,-1)])),_:1}),p(l,{to:"",class:"text-body"},{default:u(()=>t[13]||(t[13]=[e("i",{class:"fa-brands fa-google fa-lg m-2 align-middle"},null,-1)])),_:1}),p(l,{to:"",class:"text-body"},{default:u(()=>t[14]||(t[14]=[e("i",{class:"fa-brands fa-microsoft fa-lg m-2 align-middle"},null,-1)])),_:1})])])]),e("button",q,a(s.$t("AUTH.LOGIN.TITLE")),1)],32),e("div",z,[r(" © "+a(n.year)+" ",1),e("a",j,a(s.$t("APP.NAME")),1),r(" - "+a(s.$t("APP.LIC"))+". ",1)])])]),e("div",J,[e("div",K,[e("div",Y,[t[16]||(t[16]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"modal2FALabel"},"2-Faktor Authentifizierung")],-1)),e("div",Z,[e("div",Q,[t[15]||(t[15]=e("div",{class:"col-12 text-center"},"Da Sie die Zwei-Faktor-Authentifizierung in Ihrem Konto eingerichtet haben, müssen Sie nun den Code aus Ihrer Authenticator-App (TOTP) eingeben, um mit der Anmeldung fortzufahren.",-1)),e("form",{id:"2faForm",class:"col-3 mt-3",onSubmit:t[6]||(t[6]=g((...o)=>i.submit2FA&&i.submit2FA(...o),["prevent"]))},[m(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>n.form.token=o),type:"text",inputmode:"numeric",pattern:"[0-9]*",class:"form-control",autocomplete:"one-time-code",minlength:"6",maxlength:"6",placeholder:"### ###",autofocus:"",required:""},null,512),[[c,n.form.token]])],32)])]),t[17]||(t[17]=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-default","data-bs-dismiss":"modal"},"Abbrechen"),e("button",{type:"submit",class:"btn btn-primary",form:"2faForm"},"Anmelden")],-1))])])]),e("div",X,[e("div",$,[t[18]||(t[18]=e("div",{class:"toast-header"},[e("i",{class:"far fa-triangle-exclamation text-muted me-2"}),e("strong",{class:"me-auto"},"Fehler"),e("small",null,"Jetzt")],-1)),e("div",ee,a(this.errorMessage),1)])])],64)}const ie=y(F,[["render",te]]);export{ie as default};
