import{_ as h,u as f,M as y,a as d,T as b,c as w,b as e,w as _,t as a,d as l,e as u,v as c,f as m,g as p,F as v,r as k,o as x}from"./index-hv4Y3Rmp.js";import{a as g}from"./axios-CCb-kr4I.js";const A={data(){return{year:new Date().getFullYear(),form:{username:"",password:"",token:""},errorMessage:"",modal2FA:""}},mounted(){const s=f();s.appSidebarHide=!0,s.appHeaderHide=!0,s.appFooter=!1,s.appContentClass="p-0",this.modal2FA=new y(document.getElementById("modal2FA"))},beforeUnmount(){const s=f();s.appSidebarHide=!1,s.appHeaderHide=!1,s.appFooter=!0,s.appContentClass=""},methods:{async submitForm(){try{const s=await g.post("https://api.unisuite.de/auth/login",{username:this.form.username,password:this.form.password}),t={domain:".unisuite.de",path:"/",sameSite:"None",secure:!0};d.set("id_token",s.data.id_token,t),d.set("access_token",s.data.access_token,t),window.location.href="https://app.unisuite.de/"}catch(s){s.response&&s.response.data=="2FA token required"?this.modal2FA.toggle():(this.errorMessage=s.response?s.response.data:"Die Anfrage konnte nicht verarbeitet werden. Versuche es später erneut!",new b(document.getElementById("toastError")).show())}},async submit2FA(){try{const s=await g.post("https://api.unisuite.de/auth/login",{username:this.form.username,password:this.form.password,token:this.form.token}),t={domain:".unisuite.de",path:"/",sameSite:"None",secure:!0};d.set("id_token",s.data.id_token,t),d.set("access_token",s.data.access_token,t),window.location.href="https://app.unisuite.de/"}catch(s){this.errorMessage=s.response?s.response.data:"Dein Code konnte nicht geprüft werden. Versuche es später erneut!",new b(document.getElementById("toastError")).show()}},togglePWV(){const s=document.getElementById("pweye"),t=document.getElementById("pwField");s.classList.contains("fa-eye")?(s.classList.replace("fa-eye","fa-eye-slash"),t.type="text"):(s.classList.replace("fa-eye-slash","fa-eye"),t.type="password")}}},F={class:"login"},E={class:"login-content"},L={class:"text-center"},T={class:"text-inverse text-opacity-50 text-center mb-4"},I={class:"mb-3"},O={class:"d-flex"},C={class:"form-label"},N={class:"input-group flex-nowrap"},S={class:"mb-3"},M={class:"d-flex"},H={class:"form-label"},P={class:"input-group flex-nowrap"},V={class:"mb-3"},B={class:"row align-items-center"},U={class:"col-6"},D={class:"form-check"},G={class:"form-check-label",for:"customCheck1"},R={class:"col-6 text-end"},W={type:"submit",class:"btn btn-outline-theme btn-lg d-block w-100 fw-500 mb-3"},z={class:"fixed-bottom mb-2 text-center small text-inverse text-opacity-50"},q={href:"https://unisuite.de/",target:"_blank"},j={class:"modal fade",id:"modal2FA","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1","aria-labelledby":"modal2FALabel","aria-hidden":"true"},J={class:"modal-dialog modal-dialog-centered"},K={class:"modal-content"},Y={class:"modal-body"},Z={class:"row d-flex justify-content-center"},Q={class:"col-3 mt-3"},X={class:"modal-footer"},$={class:"toasts-container"},ee={class:"toast bg-warning bg-opacity-50","data-autohide":"true",id:"toastError"},te={class:"toast-body"};function se(s,t,oe,ae,n,i){const r=k("RouterLink");return x(),w(v,null,[e("div",F,[e("div",E,[e("form",{onSubmit:t[3]||(t[3]=_((...o)=>i.submitForm&&i.submitForm(...o),["prevent"])),method:"POST",name:"login_form"},[e("h1",L,a(s.$t("AUTH.LOGIN.TITLE")),1),e("div",T,a(s.$t("AUTH.LOGIN.DESC")),1),e("div",I,[e("div",O,[e("label",C,[l(a(s.$t("GENERAL.EMAIL"))+" ",1),t[6]||(t[6]=e("span",{class:"text-danger"},"*",-1))])]),e("div",N,[t[7]||(t[7]=e("i",{class:"fa-solid fa-image-portrait input-group-text",id:"addon-wrapping"},null,-1)),u(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>n.form.username=o),type:"email",class:"form-control form-control-lg bg-white bg-opacity-5 fs-14px",required:""},null,512),[[c,n.form.username]])])]),e("div",S,[e("div",M,[e("label",H,[l(a(s.$t("GENERAL.PASSWORD"))+" ",1),t[8]||(t[8]=e("span",{class:"text-danger"},"*",-1))]),m(r,{to:"/recover",class:"ms-auto text-inverse text-decoration-none text-opacity-50"},{default:p(()=>[l(a(s.$t("AUTH.LOGIN.PWFORGOT")),1)]),_:1})]),e("div",P,[t[10]||(t[10]=e("i",{class:"fa-solid fa-key input-group-text",id:"addon-wrapping"},null,-1)),u(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>n.form.password=o),type:"password",id:"pwField",class:"form-control form-control-lg bg-white bg-opacity-5 fs-14px",required:""},null,512),[[c,n.form.password]]),e("button",{type:"button",onClick:t[2]||(t[2]=(...o)=>i.togglePWV&&i.togglePWV(...o)),class:"input-group-text"},t[9]||(t[9]=[e("i",{id:"pweye",class:"fa fa-eye"},null,-1)]))])]),e("div",V,[e("div",B,[e("div",U,[e("div",D,[t[11]||(t[11]=e("input",{class:"form-check-input",type:"checkbox",value:"",id:"customCheck1"},null,-1)),e("label",G,a(s.$t("AUTH.LOGIN.REMEMBER")),1)])]),e("div",R,[m(r,{to:"",class:"text-body"},{default:p(()=>t[12]||(t[12]=[e("i",{class:"fa-brands fa-apple fa-xl m-2 align-middle",style:{height:"0.2em"}},null,-1)])),_:1}),m(r,{to:"",class:"text-body"},{default:p(()=>t[13]||(t[13]=[e("i",{class:"fa-brands fa-google fa-lg m-2 align-middle"},null,-1)])),_:1}),m(r,{to:"",class:"text-body"},{default:p(()=>t[14]||(t[14]=[e("i",{class:"fa-brands fa-microsoft fa-lg m-2 align-middle"},null,-1)])),_:1})])])]),e("button",W,a(s.$t("AUTH.LOGIN.TITLE")),1)],32),e("div",z,[l(" © "+a(n.year)+" ",1),e("a",q,a(s.$t("APP.NAME")),1),l(" - "+a(s.$t("APP.LIC"))+". ",1)])])]),e("div",j,[e("div",J,[e("div",K,[t[17]||(t[17]=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"modal2FALabel"},"2-Faktor Authentifizierung")],-1)),e("div",Y,[e("div",Z,[t[15]||(t[15]=e("div",{class:"col-12 text-center"},"Da Sie die Zwei-Faktor-Authentifizierung in Ihrem Konto eingerichtet haben, müssen Sie nun den Code aus Ihrer Authenticator-App (TOTP) eingeben, um mit der Anmeldung fortzufahren.",-1)),e("div",Q,[u(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>n.form.token=o),type:"number",class:"form-control",min:"6",max:"6",placeholder:"### ###"},null,512),[[c,n.form.token]])])])]),e("div",X,[t[16]||(t[16]=e("button",{type:"button",class:"btn btn-outline-default","data-bs-dismiss":"modal"},"Abbrechen",-1)),e("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:t[5]||(t[5]=(...o)=>i.submit2FA&&i.submit2FA(...o))},"Anmelden")])])])]),e("div",$,[e("div",ee,[t[18]||(t[18]=e("div",{class:"toast-header"},[e("i",{class:"far fa-triangle-exclamation text-muted me-2"}),e("strong",{class:"me-auto"},"Fehler"),e("small",null,"Jetzt")],-1)),e("div",te,a(this.errorMessage),1)])])],64)}const le=h(A,[["render",se]]);export{le as default};
